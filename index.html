<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Start — Instagram Simulation</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body{font-family:Arial,Helvetica,sans-serif;background:#fafafa}
.container{max-width:620px}
.profile-img{width:120px;height:120px;border-radius:50%;object-fit:cover;margin:6px;cursor:pointer;border:3px solid transparent;}
.profile-img.selected{border-color:#0d6efd}
</style>
</head>
<body>
<div class="container mt-3">
  <h3>Wähle deinen Username und Profilbild</h3>

  <div class="mb-3">
    <input id="username" class="form-control" placeholder="Dein Username">
  </div>

  <div id="profilepics" class="d-flex flex-wrap mb-3"></div>

  <div class="d-grid">
    <button id="btnNext" class="btn btn-primary">Weiter</button>
  </div>
</div>

<script>
const container = document.getElementById('profilepics');
let selectedProfile = null;

// Lade ALLE Bilder aus /images via GitHub API
async function loadProfilePics() {
  const res = await fetch("https://api.github.com/repos/eberhaan/instagram-simulationNEW/contents/images");
  const files = await res.json();
  const pics = files.filter(f => f.name.startsWith("profilepic") && f.name.endsWith(".png"));
  
  pics.forEach((file, idx) => {
    const img = document.createElement("img");
    img.src = file.download_url;
    img.className = "profile-img" + (idx===0 ? " selected" : "");
    if(idx===0) selectedProfile = file.download_url;
    img.onclick = () => {
      selectedProfile = file.download_url;
      document.querySelectorAll(".profile-img").forEach(i=>i.classList.remove("selected"));
      img.classList.add("selected");
    };
    container.appendChild(img);
  });
}

loadProfilePics();

document.getElementById("btnNext").addEventListener("click", () => {
  const username = (document.getElementById("username").value || "user123").trim();
  localStorage.setItem("sim_username", username);
  localStorage.setItem("sim_profilepic", selectedProfile);
  location.href = "select.html?p=1&c=i";
});
</script>
</body>
</html>
